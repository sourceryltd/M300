(this["webpackJsonpmakerhub-ui"]=this["webpackJsonpmakerhub-ui"]||[]).push([[0],{28:function(e,t,a){e.exports=a(45)},33:function(e,t,a){},35:function(e,t,a){},36:function(e,t,a){},37:function(e,t,a){},45:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(19),c=a.n(r),i=(a(33),a(25)),l=a(3),o=a.n(l),u=a(20),d=a(21),p=a(26),m=a(22),f=a(27);a(35),a(36);function h(e){return s.a.createElement("div",{className:"Thermometer"},e.label,s.a.createElement("div",{className:"Thermometer-Container"},s.a.createElement("div",{className:"Thermometer-Bulb-Container"}),s.a.createElement("div",{className:"Thermometer-Indicator-Container"},s.a.createElement("div",{className:"Thermometer-Indicator",style:{height:"".concat(25+(e.value-e.min)/(e.max-e.min)*100,"%")}}),s.a.createElement("div",{className:"Thermometer-Bulb"},s.a.createElement("span",null,e.value)))))}a(37);var b=a(11),E=a(7),v=a(9),g=a(10),k=new WebSocket("ws://makerhub.local:9000/sockjs/031/ata1s5hb/websocket"),N=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(p.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(s)))).state={extruder:0,bed:0,ports:[],lines:[],port:"0",baud:25e4,connected:!1,feed:"1",file:-1,files:[],printing:!1,progress:0,paused:!1},a.recieved=function(e){var t=e;if("serial"===t.channel){if(this.state.progress!==t.progress&&this.setState({progress:t.progress}),-1!==t.data.indexOf("T:")){var a=t.data.split(" ");this.setState({extruder:parseInt(a.find((function(e){return-1!==e.indexOf("T:")})).substring(2)),bed:parseInt(a.find((function(e){return-1!==e.indexOf("B:")})).substring(2))})}}else"print"===t.channel&&"done"===t.data&&this.setState({printing:!1})},a.sendGcode=function(e){fetch("http://makerhub.local:8080/api/v1/send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({gcode:e})})},a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e,t,a,n,s,r=this;return o.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,o.a.awrap(fetch("http://makerhub.local:8080/api/v1/status"));case 2:return e=c.sent,c.next=5,o.a.awrap(e.json());case 5:return t=c.sent,a=null,t.port&&(t.progress?(a=t.progress.file,this.setState({connected:!0,port:t.port.path,ports:[t.port.path],baud:t.port.baud,printing:!0})):this.setState({connected:!0,port:t.port.path,ports:[t.port.path],baud:t.port.baud})),c.next=10,o.a.awrap(fetch("http://makerhub.local:8080/api/v1/files"));case 10:return n=c.sent,c.next=13,o.a.awrap(n.json());case 13:s=c.sent,this.setState({files:s.files,file:null!==a?s.files.indexOf(a):-1}),k.onmessage=function(e){var t,a;return o.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:e.data.length>1&&(t=JSON.parse(e.data.substring(1)),console.log(t),t[0].hasOwnProperty("current")&&t[0].current.logs[0]?(r.state.progress!==t[0].current.progress.completion&&r.setState({progress:t[0].current.progress.completion}),-1!==t[0].current.logs[0].indexOf("T:")&&(a=t[0].current.logs[0].split(" "),r.setState({extruder:parseInt(a.find((function(e){return-1!==e.indexOf("T:")})).substring(2)),bed:parseInt(a.find((function(e){return-1!==e.indexOf("B:")})).substring(2))}))):100===t[0].current.progress.completion&&r.setState({printing:!1}));case 1:case"end":return n.stop()}}))};case 16:case"end":return c.stop()}}),null,this)}},{key:"render",value:function(){var e=this;return s.a.createElement(b.a,null,s.a.createElement("div",{className:"App"},s.a.createElement("header",{className:"App-Header"},s.a.createElement(b.b,{className:"Makerhub-Header",to:"/"},s.a.createElement("h2",null,"makerhub")),s.a.createElement("div",{className:"Header-Divider"}),s.a.createElement("nav",{className:"App-Nav"},s.a.createElement("ul",null,s.a.createElement("li",null,s.a.createElement(b.b,{className:"Nav-Link",to:"/"},"Status")),s.a.createElement("li",null,s.a.createElement(b.b,{className:"Nav-Link",to:"/console"},"Console")),s.a.createElement("li",null,s.a.createElement(b.b,{className:"Nav-Link",to:"/camera"},"Camera"))))),s.a.createElement("div",{className:"App-Content"},s.a.createElement("aside",{className:"App-Sidebar"},s.a.createElement("div",{className:"Connection"},s.a.createElement("label",null,"Port",s.a.createElement("select",{onChange:function(t){return e.setState({port:t.target.value})},disabled:this.state.connected,value:this.state.port,onFocus:function(){var t,a;return o.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,o.a.awrap(fetch("http://makerhub.local:8080/api/v1/serial-ports"));case 2:return t=n.sent,n.next=5,o.a.awrap(t.json());case 5:a=n.sent,e.setState({ports:a.ports});case 7:case"end":return n.stop()}}))}},s.a.createElement("option",{value:"0",disabled:!0,hidden:!0},"Select a Port"),0===this.state.ports.length?s.a.createElement("option",{value:"na",disabled:!0},"No Available Ports"):null,this.state.ports.map((function(e,t){return s.a.createElement("option",{key:t,value:e},e)})))),s.a.createElement("label",null,"Baud",s.a.createElement("select",{onChange:function(t){return e.setState({baud:parseInt(t.target.value)})},disabled:this.state.connected,defaultValue:this.state.baud},s.a.createElement("option",{value:19200},"19200"),s.a.createElement("option",{value:38400},"38400"),s.a.createElement("option",{value:57600},"57600"),s.a.createElement("option",{value:115200},"115200"),s.a.createElement("option",{value:25e4},"250000"))),s.a.createElement("button",{disabled:"0"===this.state.port,className:this.state.connected?"Disconnect":"Connect",onClick:function(){return o.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.state.connected){t.next=7;break}return t.next=3,o.a.awrap(fetch("http://makerhub.local:8080/api/v1/serial-ports",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({port:e.state.port,baud:e.state.baud})}));case 3:setTimeout((function(){return e.sendGcode("M155 S10\n")}),3e3),e.setState({connected:!0}),t.next=10;break;case 7:return t.next=9,o.a.awrap(fetch("http://makerhub.local:8080/api/v1/serial-ports",{method:"DELETE"}));case 9:e.setState({connected:!1,printing:!1});case 10:case"end":return t.stop()}}))}},this.state.connected?"Disconnect":"Connect")),s.a.createElement("div",{className:"Aside-Divider"}),s.a.createElement("div",{className:"Files"},s.a.createElement("label",{className:"Files-Upload"},s.a.createElement("span",null,"Upload"),s.a.createElement("input",{type:"file",onChange:function(t){var a;return o.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return a=new FormData,console.log(t.target.files),t.persist(),a.append("file",t.target.files[0]),n.next=6,o.a.awrap(fetch("http://makerhub.local:8080/api/v1/files/".concat(t.target.files[0].name),{method:"POST",body:a}));case 6:e.setState({files:[].concat(Object(i.a)(e.state.files),[t.target.files[0].name])});case 7:case"end":return n.stop()}}))}})),s.a.createElement("ul",{className:"Files-List"},this.state.files.map((function(t,a){return s.a.createElement("li",{key:a},s.a.createElement("button",{style:{color:e.state.printing&&e.state.file===a?"#ffffff":"",background:e.state.printing&&e.state.file===a?"linear-gradient(to right, #1f79f1 ".concat(e.state.progress,"%, #757575 ").concat(e.state.progress,"%)"):""},disabled:e.state.printing,onClick:function(){return e.setState({file:a})},className:e.state.file===a?"Active-File":""},s.a.createElement("span",null,e.state.printing&&e.state.file===a?"".concat(e.state.progress,"%"):t)))}))),s.a.createElement("ul",{className:"Files-Actions"},s.a.createElement("li",null,s.a.createElement("button",{onClick:function(){return o.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:e.state.printing?(fetch("http://makerhub.local:8080/api/v1/job",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({file:e.state.files[e.state.file]})}),e.state.paused?e.setState({paused:!1}):e.setState({paused:!0})):(fetch("http://makerhub.local:8080/api/v1/job/".concat(e.state.files[e.state.file]),{method:"POST",headers:{"Content-Type":"application/json"}}),e.setState({printing:!0}));case 1:case"end":return t.stop()}}))},disabled:-1===this.state.file,className:"Files-Print"},this.state.printing?this.state.paused?"Resume":"Pause":"Print")),s.a.createElement("li",null,s.a.createElement("button",{disabled:-1===this.state.file,className:"Files-Delete",onClick:function(){var t;return o.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(!e.state.printing){a.next=5;break}e.sendGcode("M77\n"),e.setState({paused:!1,printing:!1}),a.next=10;break;case 5:return a.next=7,o.a.awrap(fetch("http://makerhub.local:8080/api/v1/files/".concat(e.state.files[e.state.file]),{method:"DELETE"}));case 7:(t=Array.from(e.state.files)).splice(e.state.file,1),e.setState({files:t,file:-1});case 10:case"end":return a.stop()}}))}},this.state.printing?"Cancel":"Delete"))))),s.a.createElement(E.c,null,s.a.createElement(E.a,{path:"/camera"}),s.a.createElement(E.a,{path:"/console"}),s.a.createElement(E.a,{path:"/"},s.a.createElement("div",{className:"Printer-Status"},s.a.createElement("div",{className:"Jog"},s.a.createElement("div",{className:"Controls"},s.a.createElement("div",{className:"Controls-XY"},s.a.createElement("button",{disabled:!this.state.connected||this.state.printing,onClick:function(){e.sendGcode("G91\nG0 Y"+e.state.feed+"\n")}},s.a.createElement(v.a,{icon:g.d})),s.a.createElement("div",{className:"Controls-X"},s.a.createElement("button",{disabled:!this.state.connected||this.state.printing,onClick:function(){e.sendGcode("G91\nG0 X-"+e.state.feed+"\n")}},s.a.createElement(v.a,{icon:g.b})),s.a.createElement("button",{disabled:!this.state.connected||this.state.printing,onClick:function(){e.sendGcode("G91\nG0 X"+e.state.feed+"\n")}},s.a.createElement(v.a,{icon:g.c}))),s.a.createElement("button",{disabled:!this.state.connected||this.state.printing,onClick:function(){e.sendGcode("G91\nG0 Y-"+e.state.feed+"\n")}},s.a.createElement(v.a,{icon:g.a}))),s.a.createElement("div",{className:"Controls-Z"},s.a.createElement("button",{disabled:!this.state.connected||this.state.printing,onClick:function(){e.sendGcode("G91\nG0 Z"+e.state.feed+"\n")}},s.a.createElement(v.a,{icon:g.f})),s.a.createElement("button",{disabled:!this.state.connected||this.state.printing,onClick:function(){e.sendGcode("G91\nG0 Z-"+e.state.feed+"\n")}},s.a.createElement(v.a,{icon:g.e})))),s.a.createElement("div",{className:"Controls-Feed"},s.a.createElement("button",{onClick:function(){return e.setState({feed:"0.1"})},className:"0.1"===this.state.feed?"Feed-Active":""},"0.1"),s.a.createElement("button",{onClick:function(){return e.setState({feed:"1"})},className:"1"===this.state.feed?"Feed-Active":""},"1"),s.a.createElement("button",{onClick:function(){return e.setState({feed:"10"})},className:"10"===this.state.feed?"Feed-Active":""},"10"))),s.a.createElement("div",{className:"Guages"},s.a.createElement("div",null,s.a.createElement(h,{label:"Bed",value:this.state.bed,min:0,max:150})),s.a.createElement("div",null,s.a.createElement(h,{label:"Extruder",value:this.state.extruder,min:0,max:400})))))))))}}]),t}(s.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(s.a.createElement(N,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[28,1,2]]]);
//# sourceMappingURL=main.2cd37888.chunk.js.map